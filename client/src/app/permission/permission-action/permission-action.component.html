<!-- <form [formGroup]="permActForm" (ngSubmit)="save()"> -->
<!-- <div class="form-group">
    <span class="p-float-label">
      <p-inputNumber [(ngModel)]="Permissionaction.permTypeFk" inputId="integeronly" [min]="0"></p-inputNumber>
      <label htmlFor="permTypeFk">PermTypeFk</label>
    </span>
  </div> -->
  <!-- <form [formGroup]="permActForm" (ngSubmit)="save()"> -->
  <!-- <form #permActForm="ngForm" (ngSubmit)="save(permActForm)"> -->

    <br />
<form #permForm="ngForm" (ngSubmit)="save(permForm)">
  <!-- drowpdown selecte From (From subWearhouse) (getsubWearhouse()) -->
  <span class="p-float-label">
    <p-dropdown
      [options]="subWearhouses"
      [(ngModel)]="selectedSubWearFrom"
      (ngModelChange)="onSubWearhouseChange()"
      optionLabel="subName"
      [filter]="true"
      filterBy="subName"
      [showClear]="true"
      appendTo="body"
      placeholder="Select SubWarehouse"
      [editable]="true"
      name="SubWearFrom"
    >
      <ng-template pTemplate="selectedItem">
        <div class="flex align-items-center gap-2" *ngIf="selectedSubWearFrom">
          <div>
            {{ selectedSubWearFrom.subName }} - {{ selectedSubWearFrom.subId }}</div>
        </div>
      </ng-template>
      <ng-template let-item pTemplate="item">
        <div class="flex align-items-center gap-2">
          <div>{{ item.subName }}</div>
        </div>
      </ng-template>
    </p-dropdown>
    <label for="float-label">Select SubWearhouse</label>
  </span>

  <br />

  <!-- drowpdown selecte To (Destination subWherehouse) (getsubWearhouse()) -->
  <span class="p-float-label" *ngIf="headerValue == 'نقل'">
    <p-dropdown
      [options]="subWearhouses"
      [(ngModel)]="selectedSubWearTo"
      (ngModelChange)="onSubWearhouseChange()"
      optionLabel="subName"
      [filter]="true"
      filterBy="subName"
      [showClear]="true"
      appendTo="body"
      placeholder="Select Destination SubWarehouse"
      [editable]="true"
      name="SubWearTo"
    >
      <ng-template pTemplate="selectedItem">
        <div class="flex align-items-center gap-2" *ngIf="selectedSubWearTo">
          <div>
            {{ selectedSubWearTo.subName }} - {{ selectedSubWearTo.subId }}</div>
        </div>
      </ng-template>
      <ng-template let-item pTemplate="item">
        <div class="flex align-items-center gap-2">
          <div>{{ item.subName }}</div>
        </div>
      </ng-template>
    </p-dropdown>
    <label for="float-label">Select Destination SubWearHouse</label>
  </span>

  <br />

  <!-- mutiple select get all items (getItemsVM())-->
  <span class="p-float-label" *ngIf="headerValue == 'اضافة' || headerValue == 'إضافة' || headerValue == 'أضافة'">
    <p-multiSelect
      inputId="float-label"
      [options]="ItemDetailsResultVM"
      [(ngModel)]="selectedItems"
      (ngModelChange)="onMultiSelectChange($event)"
      class="ng-dirty ng-invalid"
      optionLabel="itemName"
      appendTo="body"
      display="chip"
      [showClear]="true"
      placeholder="Select Items"
      name="all item"
    ></p-multiSelect>
    <label for="float-label">Select Items</label>
  </span>

  <!-- mutiple select get items by subwearhouseBy ID(getItemsVM())-->
  <span class="p-float-label" *ngIf="headerValue == 'نقل' || headerValue == 'تالف' || headerValue == 'صرف'">
    <p-multiSelect
      inputId="float-label"
      [options]="filteredItems"
      [(ngModel)]="selectedItems"
      (ngModelChange)="onMultiSelectChange($event)"
      onChange="handleChange(event)"
      class="ng-dirty ng-invalid"
      optionLabel="itemName"
      appendTo="body"
      display="chip"
      [showClear]="true"
      placeholder="Select Items"
      name="itembysub"
    ></p-multiSelect>
    <label for="float-label">Select Items By Sub</label>
  </span>

  <p-table [value]="itemDetailsPerTab" dataKey="id" [tableStyle]="{ 'min-width': '50rem' }">
      <ng-template pTemplate="header">
          <tr>
              <!-- <th style="width: 4rem">
                <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
              </th> -->
              <th style="width:25%">Code</th>
              <th style="width:25%">Name</th>
              <th style="width:25%">Unit</th>
              <th style="width:25%">Category</th>
              <th style="width:25%">Current Quantity</th>
          </tr>
      </ng-template>
      <ng-template pTemplate="body" let-itemDetailsPerTab let-editing="editing" let-index="index">
          <tr>
              <!-- <td>
                <p-tableCheckbox [value]="product"></p-tableCheckbox>
              </td> -->
              <td >
                {{ itemDetailsPerTab.itemCode }}
              </td>
              <td>
                {{ itemDetailsPerTab.itemName }}
              </td>
              <td>
                {{ itemDetailsPerTab.unitName }}
              </td>
              <td>
                {{ itemDetailsPerTab.categoryName }}
              </td>
              <td [pEditableColumn]="itemDetailsPerTab.currentQuantity" pEditableColumnField="inventoryStatus">
                  <p-cellEditor>
                      <ng-template pTemplate="input">
                          <!-- <input pInputText [(ngModel)]="itemDetailsPerTab.currentQuantity" inputId="integeronly" [min]="0"/> -->
                          <span class="p-float-label">
                            <p-inputNumber
                              [(ngModel)]="Permissionaction.items"
                              inputId="integeronly"
                              [min]="0"
                              name="quantity"
                            ></p-inputNumber>
                            <label htmlFor="quantity">Quantity</label>
                          </span>
                      </ng-template>
                      <ng-template pTemplate="output">
                          {{ itemDetailsPerTab.currentQuantity }}
                      </ng-template>
                  </p-cellEditor>
              </td>
          </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
            <td colspan="5" style="text-align: center;"><h5>No Data Available</h5></td>
        </tr>
    </ng-template>
  </p-table>

    <br>

      <!-- <span class="p-float-label">
        <p-inputNumber
          [(ngModel)]="Permissionaction.items"
          inputId="integeronly"
          [min]="0"
        ></p-inputNumber>
        <label htmlFor="quantity">Quantity</label>
      </span> -->

      <div class="d-grid gap-2 d-md-flex justify-content-md-end">
        <button type="submit" class="btn btn-primary me-md-2">Save Permission</button>
      </div>
  </form>
